{"ast":null,"code":"import _classCallCheck from \"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nimport { sortNodes, isElement, getNextIndex, getPrevIndex } from \"./utils\";\n\n/**\n * @internal\n *\n * Class to manage descendants and their relative indices in the DOM.\n * It uses `node.compareDocumentPosition(...)` under the hood\n */\nexport var DescendantsManager = function DescendantsManager() {\n  var _this2 = this;\n  _classCallCheck(this, DescendantsManager);\n  var _this = this;\n  _defineProperty(this, \"descendants\", new Map());\n  _defineProperty(this, \"register\", function (nodeOrOptions) {\n    if (nodeOrOptions == null) return;\n    if (isElement(nodeOrOptions)) {\n      return _this2.registerNode(nodeOrOptions);\n    }\n    return function (node) {\n      _this2.registerNode(node, nodeOrOptions);\n    };\n  });\n  _defineProperty(this, \"unregister\", function (node) {\n    _this2.descendants.delete(node);\n    var sorted = sortNodes(Array.from(_this2.descendants.keys()));\n    _this2.assignIndex(sorted);\n  });\n  _defineProperty(this, \"destroy\", function () {\n    _this2.descendants.clear();\n  });\n  _defineProperty(this, \"assignIndex\", function (descendants) {\n    _this2.descendants.forEach(function (descendant) {\n      var index = descendants.indexOf(descendant.node);\n      descendant.index = index;\n      descendant.node.dataset.index = descendant.index.toString();\n    });\n  });\n  _defineProperty(this, \"count\", function () {\n    return _this2.descendants.size;\n  });\n  _defineProperty(this, \"enabledCount\", function () {\n    return _this2.enabledValues().length;\n  });\n  _defineProperty(this, \"values\", function () {\n    var values = Array.from(_this2.descendants.values());\n    return values.sort(function (a, b) {\n      return a.index - b.index;\n    });\n  });\n  _defineProperty(this, \"enabledValues\", function () {\n    return _this2.values().filter(function (descendant) {\n      return !descendant.disabled;\n    });\n  });\n  _defineProperty(this, \"item\", function (index) {\n    if (_this2.count() === 0) return undefined;\n    return _this2.values()[index];\n  });\n  _defineProperty(this, \"enabledItem\", function (index) {\n    if (_this2.enabledCount() === 0) return undefined;\n    return _this2.enabledValues()[index];\n  });\n  _defineProperty(this, \"first\", function () {\n    return _this2.item(0);\n  });\n  _defineProperty(this, \"firstEnabled\", function () {\n    return _this2.enabledItem(0);\n  });\n  _defineProperty(this, \"last\", function () {\n    return _this2.item(_this2.descendants.size - 1);\n  });\n  _defineProperty(this, \"lastEnabled\", function () {\n    var lastIndex = _this2.enabledValues().length - 1;\n    return _this2.enabledItem(lastIndex);\n  });\n  _defineProperty(this, \"indexOf\", function (node) {\n    var _this$descendants$get, _this$descendants$get2;\n    if (!node) return -1;\n    return (_this$descendants$get = (_this$descendants$get2 = _this2.descendants.get(node)) == null ? void 0 : _this$descendants$get2.index) != null ? _this$descendants$get : -1;\n  });\n  _defineProperty(this, \"enabledIndexOf\", function (node) {\n    if (node == null) return -1;\n    return _this2.enabledValues().findIndex(function (i) {\n      return i.node.isSameNode(node);\n    });\n  });\n  _defineProperty(this, \"next\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n    var next = getNextIndex(index, _this.count(), loop);\n    return _this.item(next);\n  });\n  _defineProperty(this, \"nextEnabled\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n    var item = _this.item(index);\n    if (!item) return;\n    var enabledIndex = _this.enabledIndexOf(item.node);\n    var nextEnabledIndex = getNextIndex(enabledIndex, _this.enabledCount(), loop);\n    return _this.enabledItem(nextEnabledIndex);\n  });\n  _defineProperty(this, \"prev\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n    var prev = getPrevIndex(index, _this.count() - 1, loop);\n    return _this.item(prev);\n  });\n  _defineProperty(this, \"prevEnabled\", function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n    var item = _this.item(index);\n    if (!item) return;\n    var enabledIndex = _this.enabledIndexOf(item.node);\n    var prevEnabledIndex = getPrevIndex(enabledIndex, _this.enabledCount() - 1, loop);\n    return _this.enabledItem(prevEnabledIndex);\n  });\n  _defineProperty(this, \"registerNode\", function (node, options) {\n    if (!node || _this2.descendants.has(node)) return;\n    var keys = Array.from(_this2.descendants.keys()).concat(node);\n    var sorted = sortNodes(keys);\n    if (options != null && options.disabled) {\n      options.disabled = !!options.disabled;\n    }\n    var descendant = _extends({\n      node: node,\n      index: -1\n    }, options);\n    _this2.descendants.set(node, descendant);\n    _this2.assignIndex(sorted);\n  });\n};","map":{"version":3,"names":["sortNodes","isElement","getNextIndex","getPrevIndex","DescendantsManager","_this2","_classCallCheck","_this","_defineProperty","Map","nodeOrOptions","registerNode","node","descendants","delete","sorted","Array","from","keys","assignIndex","clear","forEach","descendant","index","indexOf","dataset","toString","size","enabledValues","length","values","sort","a","b","filter","disabled","count","undefined","enabledCount","item","enabledItem","lastIndex","_this$descendants$get","_this$descendants$get2","get","findIndex","i","isSameNode","loop","next","enabledIndex","enabledIndexOf","nextEnabledIndex","prev","prevEnabledIndex","options","has","concat","_extends","set"],"sources":["../../src/descendant.ts"],"sourcesContent":["import { sortNodes, isElement, getNextIndex, getPrevIndex } from \"./utils\"\n\nexport type DescendantOptions<T = {}> = T & {\n  /**\n   * If `true`, the item will be registered in all nodes map\n   * but omitted from enabled nodes map\n   */\n  disabled?: boolean\n  /**\n   * The id of the item\n   */\n  id?: string\n}\n\nexport type Descendant<T, K> = DescendantOptions<K> & {\n  /**\n   * DOM element of the item\n   */\n  node: T\n  /**\n   * index of item in all nodes map and enabled nodes map\n   */\n  index: number\n}\n\n/**\n * @internal\n *\n * Class to manage descendants and their relative indices in the DOM.\n * It uses `node.compareDocumentPosition(...)` under the hood\n */\nexport class DescendantsManager<\n  T extends HTMLElement,\n  K extends Record<string, any> = {}\n> {\n  private descendants = new Map<T, Descendant<T, K>>()\n\n  register = (nodeOrOptions: T | null | DescendantOptions<K>) => {\n    if (nodeOrOptions == null) return\n\n    if (isElement(nodeOrOptions)) {\n      return this.registerNode(nodeOrOptions)\n    }\n\n    return (node: T | null) => {\n      this.registerNode(node, nodeOrOptions)\n    }\n  }\n\n  unregister = (node: T) => {\n    this.descendants.delete(node)\n    const sorted = sortNodes(Array.from(this.descendants.keys()))\n    this.assignIndex(sorted)\n  }\n\n  destroy = () => {\n    this.descendants.clear()\n  }\n\n  private assignIndex = (descendants: Node[]) => {\n    this.descendants.forEach((descendant) => {\n      const index = descendants.indexOf(descendant.node)\n      descendant.index = index\n      descendant.node.dataset.index = descendant.index.toString()\n    })\n  }\n\n  count = () => this.descendants.size\n\n  enabledCount = () => this.enabledValues().length\n\n  values = () => {\n    const values = Array.from(this.descendants.values())\n    return values.sort((a, b) => a.index - b.index)\n  }\n\n  enabledValues = () => {\n    return this.values().filter((descendant) => !descendant.disabled)\n  }\n\n  item = (index: number) => {\n    if (this.count() === 0) return undefined\n    return this.values()[index]\n  }\n\n  enabledItem = (index: number) => {\n    if (this.enabledCount() === 0) return undefined\n    return this.enabledValues()[index]\n  }\n\n  first = () => this.item(0)\n\n  firstEnabled = () => this.enabledItem(0)\n\n  last = () => this.item(this.descendants.size - 1)\n\n  lastEnabled = () => {\n    const lastIndex = this.enabledValues().length - 1\n    return this.enabledItem(lastIndex)\n  }\n\n  indexOf = (node: T | null) => {\n    if (!node) return -1\n    return this.descendants.get(node)?.index ?? -1\n  }\n\n  enabledIndexOf = (node: T | null) => {\n    if (node == null) return -1\n    return this.enabledValues().findIndex((i) => i.node.isSameNode(node))\n  }\n\n  next = (index: number, loop = true) => {\n    const next = getNextIndex(index, this.count(), loop)\n    return this.item(next)\n  }\n\n  nextEnabled = (index: number, loop = true) => {\n    const item = this.item(index)\n    if (!item) return\n    const enabledIndex = this.enabledIndexOf(item.node)\n    const nextEnabledIndex = getNextIndex(\n      enabledIndex,\n      this.enabledCount(),\n      loop,\n    )\n    return this.enabledItem(nextEnabledIndex)\n  }\n\n  prev = (index: number, loop = true) => {\n    const prev = getPrevIndex(index, this.count() - 1, loop)\n    return this.item(prev)\n  }\n\n  prevEnabled = (index: number, loop = true) => {\n    const item = this.item(index)\n    if (!item) return\n    const enabledIndex = this.enabledIndexOf(item.node)\n    const prevEnabledIndex = getPrevIndex(\n      enabledIndex,\n      this.enabledCount() - 1,\n      loop,\n    )\n    return this.enabledItem(prevEnabledIndex)\n  }\n\n  private registerNode = (node: T | null, options?: DescendantOptions<K>) => {\n    if (!node || this.descendants.has(node)) return\n\n    const keys = Array.from(this.descendants.keys()).concat(node)\n    const sorted = sortNodes(keys)\n\n    if (options?.disabled) {\n      options.disabled = !!options.disabled\n    }\n\n    const descendant = { node, index: -1, ...options }\n\n    this.descendants.set(node, descendant as Descendant<T, K>)\n\n    this.assignIndex(sorted)\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}