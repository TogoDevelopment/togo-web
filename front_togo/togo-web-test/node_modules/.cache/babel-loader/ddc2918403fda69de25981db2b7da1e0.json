{"ast":null,"code":"import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{FormControl}from\"react-bootstrap\";import translate from\"../i18n/translate\";import React,{useCallback,useEffect,useRef,useState}from\"react\";import Button from\"react-bootstrap/Button\";import{AddTeamMember,CreateTeam,DeleteMember,DeleteTeam,GetTeam,GetTransporterTeam,UpdateTeam}from\"./APIs/OrdersAPIs\";import{useIntl}from\"react-intl\";import{Box}from\"@chakra-ui/layout\";import DynamicTable from\"./DynamicTable/DynamicTable\";import DeleteTeamDialog from\"./DeleteTeam\";import TransferBtn from\"./TransferBtn\";import{EditTeamDialog}from\"./EditTeamDialog\";import{getWallet}from\"../APIs/ProfileAPIs\";import{setWallet}from\"../Actions/GeneralActions\";import{useDispatch}from\"react-redux\";export default function AdminBoard(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),teams=_useState2[0],setTeams=_useState2[1];var _useState3=useState([//{FullName: \"test\", PhoneNumber: \"sdfsdf\", TeamStatus: \"sdf\", TransporterId: \"44\"}\n]),_useState4=_slicedToArray(_useState3,2),members=_useState4[0],setMembers=_useState4[1];var _useState5=useState(-1),_useState6=_slicedToArray(_useState5,2),selected=_useState6[0],setSelected=_useState6[1];var intl=useIntl();var createRef=useRef();var ref=useRef();var getTrans=useCallback(function(){return GetTransporterTeam().then(function(res){setTeams(res.data.server_response);return res.data.server_response;});},[]);var getMembers=useCallback(function(){var _teams$selected;return GetTeam((_teams$selected=teams[selected])===null||_teams$selected===void 0?void 0:_teams$selected.id).then(function(res){setMembers(res.data.server_response);return res.data.server_response;});},[teams,selected]);var columns=[{label:translate(\"ADMIN.TEAM_NAME\"),key:\"Name\"},{label:\"\",key:\"id\",format:function format(_ref){var id=_ref.id,Name=_ref.Name;return/*#__PURE__*/React.createElement(DeleteTeamDialog,{teamName:Name,onConfirm:function onConfirm(){DeleteTeam(id).then(function(){getTrans();});}});}},{label:\"\",key:\"id\",format:function format(_ref2){var id=_ref2.id,Name=_ref2.Name;return/*#__PURE__*/React.createElement(EditTeamDialog,{teamName:Name,onConfirm:function onConfirm(teamName){UpdateTeam(teamName,id).then(function(){getTrans();});}});}}];var dispatch=useDispatch();var membersColumns=[{label:translate(\"ADMIN.MEMBER_NAME\"),key:\"FullName\"},{label:translate(\"ADMIN.MOBILE_NUMBER\"),key:\"PhoneNumber\"},{label:translate(\"ADMIN.STATUS\"),key:\"TeamStatus\"},//{label: translate(\"ADMIN.BALANCE\"), key: \"Balance\"},\n{label:\"\",key:\"TransporterId\",format:function format(_ref3){var TransporterId=_ref3.TransporterId,FullName=_ref3.FullName;return/*#__PURE__*/React.createElement(DeleteTeamDialog,{teamName:FullName,onConfirm:function onConfirm(){DeleteMember(TransporterId).then(function(){getMembers();});}});}},{label:\"\",key:\"TransporterId\",format:function format(_ref4){var TransporterId=_ref4.TransporterId;return/*#__PURE__*/React.createElement(TransferBtn,{TransporterId:TransporterId,onSuccess:function onSuccess(){getMembers().then(function(){getWallet().then(function(_ref5){var server_response=_ref5.data.server_response;dispatch(setWallet(server_response[0].TransporterBalance));});});}});}}];useEffect(function(){getTrans().then(function(server_response){setSelected(server_response.length?0:-1);});},[]);useEffect(function(){if(selected!==-1){getMembers();}},[selected]);return/*#__PURE__*/React.createElement(\"div\",{style:{display:\"block\",width:\"90%\",margin:\"0 auto\"}},/*#__PURE__*/React.createElement(Box,{w:\"40%\",d:\"inline-block\",borderInlineEnd:\"1px solid #dee2e6\",paddingInlineEnd:\"1%\"},/*#__PURE__*/React.createElement(Box,{d:\"flex\",borderBottom:\"1px solid #dee2e6\",pb:\"10px\",mb:\"10px\"},/*#__PURE__*/React.createElement(FormControl,{ref:createRef,defaultValue:\"\",style:{flex:\"1\",marginInlineEnd:\"10px\"},placeholder:intl.formatMessage({id:\"ADMIN.ENTER_TEAM_NAME\"})}),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",onClick:function onClick(){if(createRef.current.value.trim()===\"\"){return;}CreateTeam(createRef.current.value).then(function(){GetTransporterTeam().then(function(res){setTeams(res.data.server_response);createRef.current.value=\"\";});});}},translate(\"ADMIN.CREATE_TEAM\"))),/*#__PURE__*/React.createElement(DynamicTable,{columns:columns,data:teams,onRowSelect:function onRowSelect(info,selectedIdx){setSelected(selectedIdx);},selected:selected})),/*#__PURE__*/React.createElement(Box,{w:\"59%\",d:\"inline-block\",verticalAlign:\"top\",marginInlineStart:\"1%\"},/*#__PURE__*/React.createElement(Box,{d:\"flex\",borderBottom:\"1px solid #dee2e6\",pb:\"10px\",mb:\"10px\"},/*#__PURE__*/React.createElement(FormControl,{ref:ref,defaultValue:\"\",style:{flex:\"1\",marginInlineEnd:\"10px\"},placeholder:intl.formatMessage({id:\"ADMIN.ENTER_MEMBER_NAME\"}),disabled:selected===-1}),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",onClick:function onClick(){if(ref.current.value.trim()===\"\"){return;}AddTeamMember(teams[selected].id,ref.current.value).then(function(){GetTeam(teams[selected].id).then(function(res){setMembers(res.data.server_response);});});ref.current.value=\"\";},disabled:selected===-1},translate(\"ADMIN.ADD_MEMBER\"))),/*#__PURE__*/React.createElement(DynamicTable,{columns:membersColumns,data:members})));}","map":null,"metadata":{},"sourceType":"module"}