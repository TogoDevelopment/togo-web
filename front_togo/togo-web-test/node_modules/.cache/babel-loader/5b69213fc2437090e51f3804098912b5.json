{"ast":null,"code":"import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from\"react\";import Nav from\"react-bootstrap/Nav\";import{getFunctions}from\"../APIs/OrdersAPIs\";import{OrdersTabularView}from\"./OrdersTabularView\";import{Box}from\"@chakra-ui/react\";import Invoice from\"../Invoice/Invoice\";import{isTeamMember,isTransporter,isTransporterMaster}from\"../../Util\";import Loader from\"../Loader/Loader\";import{toastMessage}from\"../../Actions/GeneralActions\";import{useDispatch}from\"react-redux\";import translate from\"../../i18n/translate\";import{useHistory}from\"react-router-dom\";import{PAGE_SIZE}from'../UserManager/UserManager';import PaginateComp from\"../Pagination/Pagination\";import newproduct from\"../../assets/images/new-product.png\";import processingOrder from\"../../assets/images/processing-time.png\";import receipt from\"../../assets/images/receipt.png\";import processedOrder from\"../../assets/images/order-processed.png\";import voucher from\"../../assets/images/voucher.png\";import think from\"../../assets/images/affiliate-marketing.png\";import AdminBoard from\"../AdminBoard\";import{CreateNewOrder}from\"../CreateNewOrder\";import\"./Main.css\";import CreateAddress from\"../CreateAddress\";import{Button}from\"react-bootstrap\";import Network from\"../Network\";//import OrdersCardView from \"./OrdersCardView\";\nvar styles={navImg:{width:\"30px\",height:\"30px\",display:\"inline-block\",verticalAlign:\"middle\"},navLal:{display:\"inline-block\",margin:\"0 5px\",verticalAlign:\"middle\",color:\"var(--bs-dark)\"}};var getCurrentPage=function getCurrentPage(history){var pathname=history.location.pathname;return pathname.substr(pathname.lastIndexOf('/')+1,pathname.length);};var Main=function Main(){var _getCurrentPage;var history=useHistory();var _useState=useState((_getCurrentPage=getCurrentPage(history))!==null&&_getCurrentPage!==void 0?_getCurrentPage:isTeamMember()?\"current-orders\":\"all-orders\"),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),orders=_useState4[0],setOrders=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalNumOfRecs=_useState6[0],setTotalNumberOfRecs=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),activePage=_useState8[0],setActivePage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),invoices=_useState10[0],setInvoices=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),refresh=_useState14[0],setRefresh=_useState14[1];var dispatch=useDispatch();var cleanUp=function cleanUp(){setOrders([]);setInvoices([]);};useEffect(function(){var currentPage=getCurrentPage(history);if(!currentPage||currentPage==='/main'){currentPage=isTeamMember()?\"current-orders\":\"all-orders\";var currentPagePath=\"/account/main/\".concat(currentPage);history.push(currentPagePath);}setCurrentPage(currentPage);var historyUnListen=history.listen(function(location){var pathname=location.pathname;var currentPageTmp=pathname.substr(pathname.lastIndexOf('/')+1,pathname.length);if(!currentPageTmp){currentPageTmp=isTeamMember()?\"current-orders\":\"all-orders\";var _currentPagePath=\"account/main/\".concat(currentPageTmp);history.push(_currentPagePath);}setCurrentPage(currentPageTmp);});return function(){historyUnListen();cleanUp();};},[history]);var fetchData=useCallback(function(functionType,stateKey){setLoading(true);getFunctions(functionType,activePage).then(function(resp){if(resp==='NotActiveNow'){dispatch(toastMessage(translate(\"GENERAL.COULD_NOT_FETCH\"),translate(\"GENERAL.ERROR\")));}else{var _resp$data=resp.data,server_response=_resp$data.server_response,total_orders=_resp$data.total_orders;switch(stateKey){case'orders':setTotalNumberOfRecs(total_orders);setOrders(server_response);break;case'invoices':setInvoices(server_response);break;default:setTotalNumberOfRecs(0);break;}}}).catch(function(err){dispatch(toastMessage(err));}).finally(function(){setLoading(false);});},[dispatch,activePage]);useEffect(function(){var stateKey,functionType=null;cleanUp();switch(currentPage){case\"all-orders\":stateKey=\"orders\";functionType=isTransporter()?\"TransporterGetOrder\":\"ShowClientOrder\";break;case\"current-orders\":stateKey=\"orders\";functionType=isTransporter()?\"TransporterOrderCurrent\":\"ClientShowBidRequistsAccepted\";break;case\"previous-orders\":stateKey=\"orders\";functionType=isTransporter()?\"TransporterHistoryOrder\":\"ClientHistoryOrder\";break;case\"invoices\":stateKey=\"invoices\";functionType=isTransporter()?\"getTransporterInvoices\":\"getClientInvoices\";break;default:break;}if(functionType){fetchData(functionType,stateKey);}},[currentPage,fetchData,refresh]);return/*#__PURE__*/React.createElement(\"div\",null,!isTransporter()&&/*#__PURE__*/React.createElement(Box,{d:\"flex\",justifyContent:\"right\",py:\"2\",px:\"3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"m-inline-e-2\"},/*#__PURE__*/React.createElement(CreateAddress,null,/*#__PURE__*/React.createElement(Button,{className:\"font-weight-bold btn-grad text-white\",variant:\"\"},translate(\"ORDERS.ADD_ADDRESS\")))),/*#__PURE__*/React.createElement(CreateNewOrder,{onSuccess:function onSuccess(){setRefresh(!refresh);}})),/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:20,marginTop:20}},/*#__PURE__*/React.createElement(Nav,{justify:true,variant:\"tabs\",defaultActiveKey:currentPage,activeKey:currentPage,onSelect:function onSelect(eventKey){return history.push(\"/account/main/\".concat(eventKey));}},!isTeamMember()&&/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"all-orders\"},/*#__PURE__*/React.createElement(\"img\",{src:newproduct,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.NEW_ORDERS\")))),/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"current-orders\"},/*#__PURE__*/React.createElement(\"img\",{src:processingOrder,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.IN_PROCESS_ORDER\")))),/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"previous-orders\"},/*#__PURE__*/React.createElement(\"img\",{src:processedOrder,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.COMPLETED_OR_CANCELED_ORDER\")))),/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"invoices\"},/*#__PURE__*/React.createElement(\"img\",{src:voucher,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.INVOICES\")))),isTransporter()&&/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"admin\",disabled:!isTransporterMaster()},/*#__PURE__*/React.createElement(\"img\",{src:think,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ADMIN.MANAGE\")))),isTransporter()&&/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"network\"},/*#__PURE__*/React.createElement(\"img\",{src:think,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"NETWORK.NETWORK_TITLE\")))))),/*#__PURE__*/React.createElement(Box,{height:\"400px\"},loading?/*#__PURE__*/React.createElement(Loader,null):/*#__PURE__*/React.createElement(React.Fragment,null,!!orders&&currentPage.indexOf(\"orders\")!==-1&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(OrdersTabularView,{orders:orders,currentPage:currentPage,update:function update(){setRefresh(!refresh);}}),/*#__PURE__*/React.createElement(PaginateComp,{totalNumOfRecs:totalNumOfRecs,pageSize:PAGE_SIZE,activePage:activePage,setActive:setActivePage})),currentPage===\"admin\"&&isTransporter()&&/*#__PURE__*/React.createElement(AdminBoard,null),currentPage===\"network\"&&isTransporter()&&/*#__PURE__*/React.createElement(Network,null),!!invoices.length&&/*#__PURE__*/React.createElement(Invoice,{invoices:invoices}))));};export default Main;","map":null,"metadata":{},"sourceType":"module"}