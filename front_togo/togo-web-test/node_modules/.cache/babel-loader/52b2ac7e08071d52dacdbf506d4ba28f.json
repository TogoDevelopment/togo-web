{"ast":null,"code":"import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import Button from\"react-bootstrap/Button\";import Modal from\"react-bootstrap/Modal\";import InputGroup from\"react-bootstrap/InputGroup\";import FormControl from\"react-bootstrap/FormControl\";import{finalizeTrip,confirmFinalizedTrip}from\"../APIs/OrdersAPIs\";import translate from\"../../i18n/translate\";import{toastMessage}from\"../../Actions/GeneralActions\";import{useHistory}from\"react-router-dom\";import{useDispatch}from\"react-redux\";export function FinalizeOrder(_ref){var orderId=_ref.orderId;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),verificationCode=_useState4[0],setVerificationCode=_useState4[1];var history=useHistory();var dispatch=useDispatch();var handleClose=function handleClose(){setShow(false);};var handleShow=function handleShow(){return setShow(true);};var handleChange=function handleChange(e){setVerificationCode(e.target.value);};var finalizeOrder=function finalizeOrder(){handleShow();finalizeTrip(orderId);};var send=function send(lat,long){confirmFinalizedTrip(orderId,verificationCode,lat,long).then(function(resp){dispatch(toastMessage(\"ORDERS.SUCCESS_FINALIZE_ORDER\",\"GENERAL.SUCCESS\",\"success\"));history.goBack();}).catch(function(err){return dispatch(toastMessage(\"ORDERS.ERR_FINALIZE_ORDER\",\"GENERAL.ERROR\"));});};var confirmFinalizeOrder=function confirmFinalizeOrder(){if(verificationCode){navigator.geolocation.getCurrentPosition(function(pos){send(pos.coords.latitude,pos.coords.longitude);},function(){send(0,0);});}handleClose();};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{variant:\"primary\",className:\"me-1\",onClick:finalizeOrder},/*#__PURE__*/React.createElement(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",fill:\"currentColor\",className:\"bi bi-check-all\",viewBox:\"0 0 16 16\",style:{display:\"inline-block\"}},/*#__PURE__*/React.createElement(\"path\",{d:\"M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992a.252.252 0 0 1 .02-.022zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486-.943 1.179z\"})),translate(\"ORDER_DETAILS.FINALIZE_ORDER\"),\" \"),/*#__PURE__*/React.createElement(Modal,{show:show,onHide:handleClose,centered:true},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,translate(\"ORDER_DETAILS.FINALIZE_ORDER\"),orderId)),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(InputGroup,{className:\"mb-3\"},/*#__PURE__*/React.createElement(InputGroup.Text,null,translate(\"ORDER_DETAILS.VERIFICATION_CODE\")),/*#__PURE__*/React.createElement(FormControl,{value:verificationCode,onChange:handleChange}))),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(Button,{variant:\"secondary\",onClick:handleClose},translate(\"GENERAL.CLOSE\")),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",onClick:confirmFinalizeOrder},translate(\"GENERAL.PROCEED\")))));}","map":{"version":3,"sources":["/home/system/togo-web-test/src/components/OrdersManager/FinalizeOrder.jsx"],"names":["React","useState","Button","Modal","InputGroup","FormControl","finalizeTrip","confirmFinalizedTrip","translate","toastMessage","useHistory","useDispatch","FinalizeOrder","orderId","show","setShow","verificationCode","setVerificationCode","history","dispatch","handleClose","handleShow","handleChange","e","target","value","finalizeOrder","send","lat","long","then","resp","goBack","catch","err","confirmFinalizeOrder","navigator","geolocation","getCurrentPosition","pos","coords","latitude","longitude","display"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport InputGroup from \"react-bootstrap/InputGroup\";\r\nimport FormControl from \"react-bootstrap/FormControl\";\r\nimport {finalizeTrip, confirmFinalizedTrip} from \"../APIs/OrdersAPIs\";\r\nimport translate from \"../../i18n/translate\";\r\nimport {toastMessage} from \"../../Actions/GeneralActions\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport {useDispatch} from \"react-redux\";\r\n\r\nexport function FinalizeOrder({orderId}) {\r\n    const [show, setShow] = useState(false);\r\n    const [verificationCode, setVerificationCode] = useState(\"\");\r\n    const history = useHistory();\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClose = () => {\r\n        setShow(false);\r\n    };\r\n    const handleShow = () => setShow(true);\r\n\r\n    const handleChange = (e) => {\r\n        setVerificationCode(e.target.value);\r\n    };\r\n\r\n    const finalizeOrder = () => {\r\n        handleShow();\r\n        finalizeTrip(orderId);\r\n    };\r\n    const send = (lat, long) => {\r\n        confirmFinalizedTrip(orderId, verificationCode, lat, long)\r\n            .then(resp => {\r\n                dispatch(toastMessage(\"ORDERS.SUCCESS_FINALIZE_ORDER\", \"GENERAL.SUCCESS\", \"success\"));\r\n                history.goBack();\r\n            })\r\n            .catch(err => dispatch(toastMessage(\"ORDERS.ERR_FINALIZE_ORDER\", \"GENERAL.ERROR\")));\r\n        }\r\n    const confirmFinalizeOrder = () => {\r\n        if (verificationCode) {\r\n            navigator.geolocation.getCurrentPosition((pos)=>{\r\n                send(pos.coords.latitude, pos.coords.longitude);\r\n            }, ()=>{\r\n                send(0, 0);\r\n            })\r\n        }\r\n        handleClose();\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Button\r\n                variant=\"primary\"\r\n                className=\"me-1\"\r\n                onClick={finalizeOrder}\r\n            >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" className=\"bi bi-check-all\" viewBox=\"0 0 16 16\" style={{display: \"inline-block\"}}>\r\n                    <path d=\"M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992a.252.252 0 0 1 .02-.022zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486-.943 1.179z\"/>\r\n                </svg>\r\n                {translate(\"ORDER_DETAILS.FINALIZE_ORDER\")}{\" \"}\r\n            </Button>\r\n            <Modal show={show} onHide={handleClose} centered>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>{translate(\"ORDER_DETAILS.FINALIZE_ORDER\")}{orderId}</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <InputGroup className=\"mb-3\">\r\n                        <InputGroup.Text>{translate(\"ORDER_DETAILS.VERIFICATION_CODE\")}</InputGroup.Text>\r\n                        <FormControl value={verificationCode} onChange={handleChange} />\r\n                    </InputGroup>\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                        {translate(\"GENERAL.CLOSE\")}\r\n                    </Button>\r\n                    <Button variant=\"primary\" onClick={confirmFinalizeOrder}>\r\n                        {translate(\"GENERAL.PROCEED\")}\r\n                    </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}