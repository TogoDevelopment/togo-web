{"ast":null,"code":"import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button,Dropdown,Form,Modal,Spinner}from\"react-bootstrap\";import React,{useEffect,useRef,useState}from\"react\";import translate from\"../i18n/translate\";import{ReactComponent as SendIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/send.svg\";import{CreateNewOrderReq,GetDefinedAddresses}from\"../APIs/OrdersAPIs\";import{ReactComponent as FoodIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/food.svg\";import{ReactComponent as SmBoxIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/smallBox.svg\";import{ReactComponent as MedBoxIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/medbox.svg\";import{ReactComponent as BigBoxIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/largebox.svg\";import{ReactComponent as DeliveryTruckIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/deliveryTruck.svg\";import{ReactComponent as LocationIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/location.svg\";import{ReactComponent as AttachmentIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../assets/images/attachment.svg\";import{DeliveryTypes,PackageTypes}from\"./Orders/OrdersTabularView\";import AddressDropdown from\"./AddressDropdown\";import CreateAddress from\"./CreateAddress\";import{AddIcon}from\"@chakra-ui/icons\";import{useIntl}from\"react-intl\";export var PackageTypesIcons={\"1\":FoodIcon,\"2\":SmBoxIcon,\"3\":MedBoxIcon,\"4\":BigBoxIcon};export function CreateNewOrder(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openConf=_useState4[0],setOpenConf=_useState4[1];var handleClose=function handleClose(){setOpen(false);};var _useState5=useState(\"1\"),_useState6=_slicedToArray(_useState5,2),packageType=_useState6[0],setPackageType=_useState6[1];var _useState7=useState(\"1\"),_useState8=_slicedToArray(_useState7,2),deliveryType=_useState8[0],setDeliveryType=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),inputValue=_useState10[0],setInputValue=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),deliverAddresses=_useState12[0],setDeliverAddresses=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),selectedDeliveryAddress=_useState14[0],setSelectedDeliveryAddress=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),selectedPickUpAddress=_useState16[0],setSelectedPickUpAddress=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),loading=_useState18[0],setLoading=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),loadingSubmit=_useState20[0],setLoadingSubmit=_useState20[1];var orderIdRef=useRef();var notesRef=useRef();var heightRef=useRef();var widthRef=useRef();var lengthRef=useRef();var weightRef=useRef();var codAmountRef=useRef();var pickAmountRef=useRef();var intl=useIntl();useEffect(function(){var timer=setTimeout(function(){if(open){setLoading(true);GetDefinedAddresses(inputValue).then(function(res){setLoading(false);setDeliverAddresses(res.data);});}},500);return function(){return clearTimeout(timer);};},[inputValue,open]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{className:\"\".concat(props.children?\"\":\"btn-grad text-white\"),variant:\"\",onClick:function onClick(){setOpen(true);}},props.children&&props.children,!props.children&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(SendIcon,{style:{display:\"inline-block\",width:\"22px\",height:\"22px\",marginRight:\"5px\",fill:\"currentcolor\"}}),translate(\"ORDERS.CREATE_ORDER\"))),/*#__PURE__*/React.createElement(Modal,{size:\"lg\",show:open,onHide:handleClose,centered:true,animation:false,backdrop:\"static\"},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,translate(\"ORDERS.CREATE_ORDER\"))),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"my-1\"},translate(\"ORDERS.WHAT_TO_TRANS\")),/*#__PURE__*/React.createElement(Dropdown,{className:\"togo-dropdown\",onSelect:function onSelect(eve){setPackageType(eve);}},/*#__PURE__*/React.createElement(Dropdown.Toggle,{variant:\"\",className:\"w-100 text-start d-flex align-items-center\"},React.createElement(PackageTypesIcons[packageType],{style:{width:\"20px\",height:\"20px\"},className:\"me-1\"}),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"97%\"}},translate(\"ORDERS.\"+PackageTypes[packageType]))),/*#__PURE__*/React.createElement(Dropdown.Menu,{className:\"w-100\"},/*#__PURE__*/React.createElement(Dropdown.Item,{eventKey:\"1\",className:\"d-flex\"},/*#__PURE__*/React.createElement(FoodIcon,{style:{width:\"20px\",height:\"20px\"},className:\"me-1\"}),translate(\"ORDERS.\"+PackageTypes[1])),/*#__PURE__*/React.createElement(Dropdown.Item,{eventKey:\"4\",className:\"d-flex\"},/*#__PURE__*/React.createElement(BigBoxIcon,{style:{width:\"20px\",height:\"20px\"},className:\"me-1\"}),translate(\"ORDERS.\"+PackageTypes[4])),/*#__PURE__*/React.createElement(Dropdown.Item,{eventKey:\"3\",className:\"d-flex\"},/*#__PURE__*/React.createElement(MedBoxIcon,{style:{width:\"20px\",height:\"20px\"},className:\"me-1\"}),translate(\"ORDERS.\"+PackageTypes[3])),/*#__PURE__*/React.createElement(Dropdown.Item,{eventKey:\"2\",className:\"d-flex\"},/*#__PURE__*/React.createElement(SmBoxIcon,{style:{width:\"20px\",height:\"20px\"},className:\"me-1\"}),translate(\"ORDERS.\"+PackageTypes[2])))),/*#__PURE__*/React.createElement(Form.Group,{onChange:function onChange(event){if(event.target.name===\"DeliveryType\"){setDeliveryType(event.target.value);}}},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center my-1\"},/*#__PURE__*/React.createElement(DeliveryTruckIcon,{style:{width:\"15px\",height:\"15px\"},className:\"me-1\"}),translate(\"ORDERS.DELIVERY_TYPE\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\",style:{height:\"40px\"}},/*#__PURE__*/React.createElement(Form.Check,{type:\"radio\",label:translate(\"ORDERS.\"+DeliveryTypes[1]),name:\"DeliveryType\",id:\"formHorizontalRadios1\",value:\"1\",defaultChecked:deliveryType===\"1\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\",style:{height:\"40px\"}},/*#__PURE__*/React.createElement(Form.Check,{type:\"radio\",label:translate(\"ORDERS.\"+DeliveryTypes[2]),name:\"DeliveryType\",id:\"formHorizontalRadios2\",value:\"2\",defaultChecked:deliveryType===\"2\"}),deliveryType===\"2\"&&/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",className:\"ms-auto w-25\",placeholder:intl.formatMessage({id:\"ORDERS.AMOUNT\"}),ref:codAmountRef})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\",style:{height:\"40px\"}},/*#__PURE__*/React.createElement(Form.Check,{type:\"radio\",label:translate(\"ORDERS.\"+DeliveryTypes[3]),name:\"DeliveryType\",id:\"formHorizontalRadios3\",value:\"3\",defaultChecked:deliveryType===\"3\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\",style:{height:\"40px\"}},/*#__PURE__*/React.createElement(Form.Check,{type:\"radio\",label:translate(\"ORDERS.\"+DeliveryTypes[4]),name:\"DeliveryType\",id:\"formHorizontalRadios4\",value:\"4\",defaultChecked:deliveryType===\"4\"}),deliveryType===\"4\"&&/*#__PURE__*/React.createElement(Form.Control,{ref:pickAmountRef,type:\"number\",className:\"ms-auto w-25\",placeholder:intl.formatMessage({id:\"ORDERS.AMOUNT\"})}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"w-50 m-inline-e-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center my-1\"},/*#__PURE__*/React.createElement(LocationIcon,{style:{width:\"15px\",height:\"15px\"},className:\"me-1\"}),translate(\"ORDERS.PICKUP_ADDRESS\")),/*#__PURE__*/React.createElement(AddressDropdown,{loading:loading,addresses:deliverAddresses,onSearch:setInputValue,onSelect:setSelectedPickUpAddress,selectedAddress:selectedPickUpAddress})),/*#__PURE__*/React.createElement(\"div\",{className:\"w-50 m-inline-e-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center my-1\"},/*#__PURE__*/React.createElement(SendIcon,{style:{width:\"15px\",height:\"15px\"},className:\"me-1\"}),/*#__PURE__*/React.createElement(\"p\",null,translate(\"ORDERS.DELIVER_TO\"))),/*#__PURE__*/React.createElement(AddressDropdown,{loading:loading,addresses:deliverAddresses,onSearch:setInputValue,onSelect:setSelectedDeliveryAddress,selectedAddress:selectedDeliveryAddress})),/*#__PURE__*/React.createElement(CreateAddress,null,/*#__PURE__*/React.createElement(\"div\",{className:\"btn-grad p-2 rounded-circle\"},/*#__PURE__*/React.createElement(AddIcon,{w:6,h:6,color:\"gray.50\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center my-1\"},/*#__PURE__*/React.createElement(AttachmentIcon,{style:{width:\"15px\",height:\"15px\"},className:\"me-1\"}),translate(\"ORDERS.ATTACHMENTS_LABEL\")),packageType!==\"1\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"my-1\"},translate(\"ORDERS.DIMENSIONS_LABEL\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",className:\"me-2\",placeholder:\"Height\",ref:heightRef}),/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",className:\"me-2\",placeholder:\"Width\",ref:widthRef}),/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",className:\"\",placeholder:\"Length\",ref:lengthRef})),/*#__PURE__*/React.createElement(Form.Control,{type:\"number\",className:\"mt-2\",placeholder:\"Weight\",ref:weightRef})),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",className:\"mt-2\",placeholder:\"Notes\",ref:notesRef})),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(Button,{variant:\"\",className:\"togo-button w-100\",disabled:loadingSubmit,onClick:function onClick(){var _lengthRef$current,_widthRef$current,_heightRef$current,_weightRef$current;setLoadingSubmit(true);var DeliveryParams={deliveryWay:deliveryType,TypeLoad:packageType,CostLoad:deliveryType===\"2\"&&codAmountRef.current.value||deliveryType===\"4\"&&pickAmountRef.current.value||\"\",// 2 or 4\nDetailsLoad:notesRef.current.value,LengthLoad:((_lengthRef$current=lengthRef.current)===null||_lengthRef$current===void 0?void 0:_lengthRef$current.value)||\"\",WidthLoad:((_widthRef$current=widthRef.current)===null||_widthRef$current===void 0?void 0:_widthRef$current.value)||\"\",HeightLoad:((_heightRef$current=heightRef.current)===null||_heightRef$current===void 0?void 0:_heightRef$current.value)||\"\",WeightLoad:((_weightRef$current=weightRef.current)===null||_weightRef$current===void 0?void 0:_weightRef$current.value)||\"\",qrCode:\"\"};var AddressClint={IdCity:selectedPickUpAddress.cityId,// from selected pick up address\nOtherDetails:selectedPickUpAddress.details,// details from selected pickup address\nLatSender:selectedPickUpAddress.latitude,// from selected pick up address\nLongSender:selectedPickUpAddress.longitude,//  from selected pick up address\nSenderAddressId:selectedPickUpAddress.id,// from selected pick up address\nIdCityDes:selectedDeliveryAddress.cityId,// from selected delivery to address\nOtherDetailsDes:selectedDeliveryAddress.details,// details from selected delivery to address\nLatReciver:selectedDeliveryAddress.latitude,// from selected delivery to address\nLongReciver:selectedDeliveryAddress.longitude,// from selected delivery to address\nReciverAddressId:selectedDeliveryAddress.id,// from selected delivery to address\nReceiverAddressNum:selectedDeliveryAddress.phone_number};CreateNewOrderReq(JSON.stringify(DeliveryParams),JSON.stringify(AddressClint)).then(function(res){orderIdRef.current=JSON.parse(res.data.replace(\"}{\",\",\")).server_response[0].OrderId;//https://therichpost.com/reactjs-convert-html-into-pdf-working-functionality/\nsetOpenConf(true);setOpen(false);setLoadingSubmit(false);props.onSuccess();});/* - deliveryWay \r\n        This one from radio button for delivery type it contains four values \r\n            (Delivery = 1, Cache on delivery = 2, Pickup = 3, Pay and Pickup = 4)\r\n    - CostLoad   \r\n        This amount inserted in case of (Cache on delivery/Pay and pickup)\r\n    - TypeLoad   \r\n        This one from the list we pick Food or Small/Medium/Large package where \r\n            Food = 1, Small Package = 2, Medium Package =3, Large Package = 4\r\n    - qrCode\r\n        in case of submit with qrcode we will put the value else it will be empty */}},loadingSubmit&&/*#__PURE__*/React.createElement(Spinner,{animation:\"border\",size:\"sm\"}),translate(\"ORDERS.SUBMIT\")))),/*#__PURE__*/React.createElement(Modal,{show:openConf,onHide:function onHide(){setOpenConf(false);},animation:false,backdrop:\"static\"},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,\"Confirmation\")),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"p\",null,\"Would you like to print a waybill ?\")),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(Button,{variant:\"secondary\",onClick:function onClick(){setOpenConf(false);}},\"No\"),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",onClick:function onClick(){setOpenConf(false);window.open(\"/account/bill-for-order/\"+orderIdRef.current+\"?print=true\");}},\"Yes\"))));}","map":null,"metadata":{},"sourceType":"module"}