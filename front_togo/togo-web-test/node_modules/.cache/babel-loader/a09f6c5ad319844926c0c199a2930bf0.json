{"ast":null,"code":"import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from\"react\";import Nav from\"react-bootstrap/Nav\";import{getFunctions}from\"../APIs/OrdersAPIs\";import{OrdersTabularView}from\"./OrdersTabularView\";import{Box}from\"@chakra-ui/react\";import Invoice from\"../Invoice/Invoice\";import{isTeamMember,isTransporter,isTransporterMaster}from\"../../Util\";import Loader from\"../Loader/Loader\";import{toastMessage}from\"../../Actions/GeneralActions\";import{useDispatch}from\"react-redux\";import translate from\"../../i18n/translate\";import{useHistory}from\"react-router-dom\";import{PAGE_SIZE}from'../UserManager/UserManager';import PaginateComp from\"../Pagination/Pagination\";import newproduct from\"../../assets/images/new-product.png\";import processingOrder from\"../../assets/images/processing-time.png\";import receipt from\"../../assets/images/receipt.png\";import processedOrder from\"../../assets/images/order-processed.png\";import voucher from\"../../assets/images/voucher.png\";import think from\"../../assets/images/affiliate-marketing.png\";import AdminBoard from\"../AdminBoard\";import{CreateNewOrder}from\"../CreateNewOrder\";import\"./Main.css\";import CreateAddress from\"../CreateAddress\";import{Button}from\"react-bootstrap\";import Network from\"../Network\";//import OrdersCardView from \"./OrdersCardView\";\nvar styles={navImg:{width:\"30px\",height:\"30px\",display:\"inline-block\",verticalAlign:\"middle\"},navLal:{display:\"inline-block\",margin:\"0 5px\",verticalAlign:\"middle\",color:\"var(--bs-dark)\"}};var getCurrentPage=function getCurrentPage(history){var pathname=history.location.pathname;return pathname.substr(pathname.lastIndexOf('/')+1,pathname.length);};var Main=function Main(){var _getCurrentPage;var history=useHistory();var _useState=useState((_getCurrentPage=getCurrentPage(history))!==null&&_getCurrentPage!==void 0?_getCurrentPage:isTeamMember()?\"current-orders\":\"all-orders\"),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),orders=_useState4[0],setOrders=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalNumOfRecs=_useState6[0],setTotalNumberOfRecs=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),activePage=_useState8[0],setActivePage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),invoices=_useState10[0],setInvoices=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),refresh=_useState14[0],setRefresh=_useState14[1];var dispatch=useDispatch();var cleanUp=function cleanUp(){setOrders([]);setInvoices([]);};useEffect(function(){var currentPage=getCurrentPage(history);if(!currentPage||currentPage==='/main'){currentPage=isTeamMember()?\"current-orders\":\"all-orders\";var currentPagePath=\"/account/main/\".concat(currentPage);history.push(currentPagePath);}setCurrentPage(currentPage);var historyUnListen=history.listen(function(location){var pathname=location.pathname;var currentPageTmp=pathname.substr(pathname.lastIndexOf('/')+1,pathname.length);if(!currentPageTmp){currentPageTmp=isTeamMember()?\"current-orders\":\"all-orders\";var _currentPagePath=\"account/main/\".concat(currentPageTmp);history.push(_currentPagePath);}setCurrentPage(currentPageTmp);});return function(){historyUnListen();cleanUp();};},[history]);var fetchData=useCallback(function(functionType,stateKey){setLoading(true);getFunctions(functionType,activePage).then(function(resp){if(resp==='NotActiveNow'){dispatch(toastMessage(translate(\"GENERAL.COULD_NOT_FETCH\"),translate(\"GENERAL.ERROR\")));}else{var _resp$data=resp.data,server_response=_resp$data.server_response,total_orders=_resp$data.total_orders;switch(stateKey){case'orders':setTotalNumberOfRecs(total_orders);setOrders(server_response);break;case'invoices':setInvoices(server_response);break;default:setTotalNumberOfRecs(0);break;}}}).catch(function(err){dispatch(toastMessage(err));}).finally(function(){setLoading(false);});},[dispatch,activePage]);useEffect(function(){var stateKey,functionType=null;cleanUp();switch(currentPage){case\"all-orders\":stateKey=\"orders\";functionType=isTransporter()?\"TransporterGetOrder\":\"ShowClientOrder\";break;case\"current-orders\":stateKey=\"orders\";functionType=isTransporter()?\"TransporterOrderCurrent\":\"ClientShowBidRequistsAccepted\";break;case\"previous-orders\":stateKey=\"orders\";functionType=isTransporter()?\"TransporterHistoryOrder\":\"ClientHistoryOrder\";break;case\"invoices\":stateKey=\"invoices\";functionType=isTransporter()?\"getTransporterInvoices\":\"getClientInvoices\";break;default:break;}if(functionType){fetchData(functionType,stateKey);}},[currentPage,fetchData,refresh]);return/*#__PURE__*/React.createElement(\"div\",null,!isTransporter()&&/*#__PURE__*/React.createElement(Box,{d:\"flex\",justifyContent:\"right\",py:\"2\",px:\"3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"m-inline-e-2\"},/*#__PURE__*/React.createElement(CreateAddress,null,/*#__PURE__*/React.createElement(Button,{className:\"font-weight-bold btn-grad text-white\",variant:\"\"},translate(\"ORDERS.ADD_ADDRESS\")))),/*#__PURE__*/React.createElement(CreateNewOrder,{onSuccess:function onSuccess(){setRefresh(!refresh);}})),/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:20,marginTop:20}},/*#__PURE__*/React.createElement(Nav,{justify:true,variant:\"tabs\",defaultActiveKey:currentPage,activeKey:currentPage,onSelect:function onSelect(eventKey){return history.push(\"/account/main/\".concat(eventKey));}},!isTeamMember()&&/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"all-orders\"},/*#__PURE__*/React.createElement(\"img\",{src:newproduct,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.NEW_ORDERS\")))),/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"current-orders\"},/*#__PURE__*/React.createElement(\"img\",{src:processingOrder,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.IN_PROCESS_ORDER\")))),/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"previous-orders\"},/*#__PURE__*/React.createElement(\"img\",{src:processedOrder,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.COMPLETED_OR_CANCELED_ORDER\")))),/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"invoices\"},/*#__PURE__*/React.createElement(\"img\",{src:voucher,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ORDERS.INVOICES\")))),isTransporter()&&/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"admin\",disabled:!isTransporterMaster()},/*#__PURE__*/React.createElement(\"img\",{src:think,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ADMIN.MANAGE\")))),isTransporter()&&/*#__PURE__*/React.createElement(Nav.Item,null,/*#__PURE__*/React.createElement(Nav.Link,{eventKey:\"network\"},/*#__PURE__*/React.createElement(\"img\",{src:think,alt:\"new\",style:styles.navImg}),/*#__PURE__*/React.createElement(\"div\",{style:styles.navLal},translate(\"ADMIN.MY_NETWORK\")))))),/*#__PURE__*/React.createElement(Box,{height:\"400px\"},loading?/*#__PURE__*/React.createElement(Loader,null):/*#__PURE__*/React.createElement(React.Fragment,null,!!orders&&currentPage.indexOf(\"orders\")!==-1&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(OrdersTabularView,{orders:orders,currentPage:currentPage,update:function update(){setRefresh(!refresh);}}),/*#__PURE__*/React.createElement(PaginateComp,{totalNumOfRecs:totalNumOfRecs,pageSize:PAGE_SIZE,activePage:activePage,setActive:setActivePage})),currentPage===\"admin\"&&isTransporter()&&/*#__PURE__*/React.createElement(AdminBoard,null),currentPage===\"network\"&&isTransporter()&&/*#__PURE__*/React.createElement(Network,null),!!invoices.length&&/*#__PURE__*/React.createElement(Invoice,{invoices:invoices}))));};export default Main;","map":{"version":3,"sources":["/home/system/togo-web-test/src/components/Orders/Main.jsx"],"names":["React","useCallback","useEffect","useState","Nav","getFunctions","OrdersTabularView","Box","Invoice","isTeamMember","isTransporter","isTransporterMaster","Loader","toastMessage","useDispatch","translate","useHistory","PAGE_SIZE","PaginateComp","newproduct","processingOrder","receipt","processedOrder","voucher","think","AdminBoard","CreateNewOrder","CreateAddress","Button","Network","styles","navImg","width","height","display","verticalAlign","navLal","margin","color","getCurrentPage","history","pathname","location","substr","lastIndexOf","length","Main","currentPage","setCurrentPage","orders","setOrders","totalNumOfRecs","setTotalNumberOfRecs","activePage","setActivePage","invoices","setInvoices","loading","setLoading","refresh","setRefresh","dispatch","cleanUp","currentPagePath","push","historyUnListen","listen","currentPageTmp","fetchData","functionType","stateKey","then","resp","data","server_response","total_orders","catch","err","finally","marginBottom","marginTop","eventKey","indexOf"],"mappings":"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","sourcesContent":["import React, {useCallback, useEffect, useState} from \"react\";\r\nimport Nav from \"react-bootstrap/Nav\";\r\n\r\nimport {getFunctions} from \"../APIs/OrdersAPIs\";\r\nimport {OrdersTabularView} from \"./OrdersTabularView\";\r\nimport {Box} from \"@chakra-ui/react\";\r\nimport Invoice from \"../Invoice/Invoice\";\r\nimport {isTeamMember, isTransporter, isTransporterMaster} from \"../../Util\";\r\nimport Loader from \"../Loader/Loader\";\r\nimport {toastMessage} from \"../../Actions/GeneralActions\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport translate from \"../../i18n/translate\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport {PAGE_SIZE} from '../UserManager/UserManager';\r\nimport PaginateComp from \"../Pagination/Pagination\";\r\n\r\nimport newproduct from \"../../assets/images/new-product.png\";\r\nimport processingOrder from \"../../assets/images/processing-time.png\";\r\nimport receipt from \"../../assets/images/receipt.png\";\r\nimport processedOrder from \"../../assets/images/order-processed.png\";\r\nimport voucher from \"../../assets/images/voucher.png\";\r\nimport think from \"../../assets/images/affiliate-marketing.png\";\r\n\r\nimport AdminBoard from \"../AdminBoard\";\r\nimport { CreateNewOrder } from \"../CreateNewOrder\";\r\nimport \"./Main.css\";\r\nimport CreateAddress from \"../CreateAddress\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport Network from \"../Network\";\r\n//import OrdersCardView from \"./OrdersCardView\";\r\n\r\nconst styles = {\r\n    navImg: {\r\n        width: \"30px\",\r\n        height: \"30px\",\r\n        display: \"inline-block\",\r\n\r\n        verticalAlign: \"middle\",\r\n    },\r\n    navLal: {\r\n        display: \"inline-block\",\r\n        margin: \"0 5px\",\r\n        verticalAlign: \"middle\",\r\n        color: \"var(--bs-dark)\"\r\n    }\r\n};\r\nconst getCurrentPage = (history) => {\r\n    const pathname = history.location.pathname;\r\n    return pathname.substr(pathname.lastIndexOf('/') + 1, pathname.length);\r\n}\r\n\r\nconst Main = () => {\r\n    let history = useHistory();\r\n\r\n    const [currentPage, setCurrentPage] = useState(getCurrentPage(history) ?? (isTeamMember() ? \"current-orders\" : \"all-orders\"));\r\n    const [orders, setOrders] = useState([]);\r\n    const [totalNumOfRecs, setTotalNumberOfRecs] = useState(0);\r\n    const [activePage, setActivePage] = useState(0);\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [refresh, setRefresh] = useState(false);\r\n    const dispatch = useDispatch();\r\n\r\n    const cleanUp = () => {\r\n        setOrders([]);\r\n        setInvoices([]);\r\n    };\r\n\r\n    useEffect(() => {\r\n        let currentPage = getCurrentPage(history);\r\n        if (!currentPage || currentPage === '/main') {\r\n            currentPage = isTeamMember() ? \"current-orders\" : \"all-orders\";\r\n            let currentPagePath = `/account/main/${currentPage}`;\r\n            history.push(currentPagePath);\r\n        }\r\n        setCurrentPage(currentPage);\r\n\r\n        let historyUnListen = history.listen(location => {\r\n            const pathname = location.pathname;\r\n            let currentPageTmp = pathname.substr(pathname.lastIndexOf('/') + 1, pathname.length);\r\n            if (!currentPageTmp) {\r\n                currentPageTmp = isTeamMember() ? \"current-orders\" : \"all-orders\";\r\n                let currentPagePath = `account/main/${currentPageTmp}`;\r\n                history.push(currentPagePath);\r\n            }\r\n            setCurrentPage(currentPageTmp);\r\n        });\r\n\r\n        return () => {\r\n            historyUnListen();\r\n            cleanUp();\r\n        }\r\n    }, [history]);\r\n\r\n    const fetchData = useCallback((functionType, stateKey) => {\r\n        setLoading(true);\r\n        getFunctions(functionType, activePage)\r\n            .then(resp => {\r\n                if (resp === 'NotActiveNow') {\r\n                    dispatch(toastMessage(translate(\"GENERAL.COULD_NOT_FETCH\"), translate(\"GENERAL.ERROR\")));\r\n                } else {\r\n                    const {data: {server_response, total_orders}} = resp;\r\n                    switch (stateKey) {\r\n                        case 'orders':\r\n                            setTotalNumberOfRecs(total_orders);\r\n                            setOrders(server_response);\r\n                            break;\r\n                        case 'invoices':\r\n                            setInvoices(server_response);\r\n                            break;\r\n                        default:\r\n                            setTotalNumberOfRecs(0);\r\n                            break;\r\n                    }\r\n                }\r\n            })\r\n            .catch((err) => {\r\n                dispatch(toastMessage(err));\r\n            }).finally(() => {\r\n                setLoading(false);\r\n            });\r\n    }, [dispatch, activePage]);\r\n\r\n    useEffect(() => {\r\n        let stateKey, functionType = null;\r\n        cleanUp();\r\n        switch (currentPage) {\r\n            case \"all-orders\":\r\n                stateKey = \"orders\";\r\n                functionType = isTransporter() ? \"TransporterGetOrder\" : \"ShowClientOrder\";\r\n                break;\r\n            case \"current-orders\":\r\n                stateKey = \"orders\";\r\n                functionType = isTransporter() ? \"TransporterOrderCurrent\" : \"ClientShowBidRequistsAccepted\";\r\n                break;\r\n            case \"previous-orders\":\r\n                stateKey = \"orders\";\r\n                functionType = isTransporter() ? \"TransporterHistoryOrder\" : \"ClientHistoryOrder\";\r\n                break;\r\n            case \"invoices\":\r\n                stateKey = \"invoices\";\r\n                functionType = isTransporter() ? \"getTransporterInvoices\" : \"getClientInvoices\";\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if(functionType){\r\n            fetchData(functionType, stateKey);\r\n        }\r\n    }, [currentPage, fetchData, refresh]);\r\n\r\n    return (\r\n        <div>\r\n            {!isTransporter() && <Box d=\"flex\" justifyContent=\"right\" py=\"2\" px=\"3\">\r\n                <div className=\"m-inline-e-2\">\r\n                    <CreateAddress>\r\n                        <Button\r\n                            className=\"font-weight-bold btn-grad text-white\"\r\n                            variant=\"\"\r\n                            >\r\n                            {translate(\"ORDERS.ADD_ADDRESS\")}\r\n                        </Button>\r\n                    </CreateAddress>\r\n                </div>\r\n                <CreateNewOrder onSuccess={()=>{\r\n                    setRefresh(!refresh);\r\n                }}/>\r\n            </Box>}\r\n            <div style={{marginBottom: 20, marginTop: 20}}>\r\n                <Nav\r\n                    justify\r\n                    variant=\"tabs\"\r\n                    defaultActiveKey={currentPage}\r\n                    activeKey={currentPage}\r\n                    onSelect={(eventKey) => history.push(`/account/main/${eventKey}`)}\r\n                >\r\n                    {!isTeamMember() && <Nav.Item>\r\n                        <Nav.Link eventKey=\"all-orders\">\r\n                            <img src={newproduct} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>{translate(\"ORDERS.NEW_ORDERS\")}</div>\r\n                        </Nav.Link>\r\n                    </Nav.Item>}\r\n                    <Nav.Item>\r\n                        <Nav.Link eventKey=\"current-orders\">\r\n                            <img src={processingOrder} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>{translate(\"ORDERS.IN_PROCESS_ORDER\")}</div>\r\n                        </Nav.Link>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <Nav.Link eventKey=\"previous-orders\">\r\n                            <img src={processedOrder} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>\r\n                                {translate(\"ORDERS.COMPLETED_OR_CANCELED_ORDER\")}\r\n                            </div>\r\n                        </Nav.Link>\r\n                    </Nav.Item>\r\n                    {/* <Nav.Item>\r\n                        <Nav.Link eventKey=\"financial-transaction\">\r\n                            <img src={receipt} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>\r\n                                {translate(\"ORDERS.FINANCIAL_TRANSACTIONS\")}\r\n                            </div>\r\n                        </Nav.Link>\r\n                    </Nav.Item> */}\r\n                    <Nav.Item>\r\n                        <Nav.Link eventKey=\"invoices\">\r\n                            <img src={voucher} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>\r\n                                {translate(\"ORDERS.INVOICES\")}\r\n                            </div>\r\n                        </Nav.Link>\r\n                    </Nav.Item>\r\n                    {isTransporter() && <Nav.Item>\r\n                        <Nav.Link eventKey=\"admin\" disabled={!isTransporterMaster()}>\r\n                            <img src={think} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>\r\n                                {translate(\"ADMIN.MANAGE\")}\r\n                            </div>\r\n                        </Nav.Link>\r\n                    </Nav.Item>}\r\n                    {isTransporter() && <Nav.Item>\r\n                        <Nav.Link eventKey=\"network\">\r\n                            <img src={think} alt=\"new\" style={styles.navImg} />\r\n                            <div style={styles.navLal}>\r\n                                {translate(\"ADMIN.MY_NETWORK\")}\r\n                            </div>\r\n                        </Nav.Link>\r\n                    </Nav.Item>}\r\n                </Nav>\r\n            </div>\r\n\r\n            <Box height=\"400px\">\r\n                {loading ? <Loader/> : (\r\n                    <>\r\n                        {!!orders && currentPage.indexOf(\"orders\") !== -1 &&\r\n                        <>\r\n                            {/* <OrdersCardView orders={orders} /> */}\r\n                            <OrdersTabularView\r\n                                orders={orders}\r\n                                currentPage={currentPage}\r\n                                update={()=>{setRefresh(!refresh);}}\r\n                            />\r\n                            <PaginateComp\r\n                                totalNumOfRecs={totalNumOfRecs}\r\n                                pageSize={PAGE_SIZE}\r\n                                activePage={activePage}\r\n                                setActive={setActivePage}\r\n                            />\r\n                        </>\r\n                        }\r\n\r\n                        {currentPage === \"admin\" && isTransporter() && <AdminBoard />}\r\n\r\n                        {currentPage === \"network\" && isTransporter() && <Network />}\r\n\r\n                        {!!invoices.length && <Invoice invoices={invoices} /> }\r\n                    </>\r\n                )}\r\n            </Box>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Main;\r\n"]},"metadata":{},"sourceType":"module"}