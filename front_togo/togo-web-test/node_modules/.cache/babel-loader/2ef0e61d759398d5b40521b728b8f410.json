{"ast":null,"code":"import _objectSpread from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useLocation,useParams,useHistory}from\"react-router-dom\";import{AcceptOfferReq,GetAllBids,GetClientOrderDetails}from\"../APIs/OrdersAPIs\";import locationImg from\"../../assets/locationn.png\";import Order,{GetOrderStatus}from\"./Order\";import{Button}from\"react-bootstrap\";import{CancelOrder}from\"../OrdersManager/CancelOrder\";import{refreshPage}from\"../Functions/CommonFunctions\";function Label(_ref){var val=_ref.val,text=_ref.text;return/*#__PURE__*/React.createElement(\"div\",{className:\"w-50\"},/*#__PURE__*/React.createElement(\"div\",{className:\"order-prop-label\"},text),/*#__PURE__*/React.createElement(\"div\",null,val));}export default function ViewOrder(props){var _useParams=useParams(),id=_useParams.id;var location=useLocation();var history=useHistory();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),orderInfo=_useState2[0],setOrderInfo=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),orderMoreInfo=_useState4[0],setOrderMoreInfo=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),costDetail=_useState6[0],setCostDetails=_useState6[1];useEffect(function(){GetClientOrderDetails(id).then(function(res){setOrderMoreInfo(res.data.server_response[0]);});GetAllBids(id).then(function(res){setOrderInfo(_objectSpread(_objectSpread({},res.data.OrderDetail),{},{bidsCount:res.data.BidCount}));setCostDetails(res.data.CostDetail);});},[id]);var orderStatus=GetOrderStatus(orderInfo.IsAcceptDelivery,orderInfo.Orderfinished,orderInfo.pickup_date,costDetail.length);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Order,{order:orderInfo/* location.state.orderObj */,id:id}),/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Label,{val:orderInfo.PickupName,text:\"Pickup From\"}),/*#__PURE__*/React.createElement(Label,{val:orderInfo.PickupMobile,text:\"Pickup Mobile Number\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Label,{val:orderInfo.ReceiverName,text:\"Receiver Name\"}),/*#__PURE__*/React.createElement(Label,{val:orderInfo.ReceiverMobile,text:\"Receiver Mobile Number\"}))),(orderStatus==\"WAITING-FOR-BIDS\"||orderStatus==\"AVAILABEL-BIDS\")&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(CancelOrder,{orderId:id,className:\"mt-3 d-flex align-items-center m-auto btn-grad rounded-22\",onSuccess:function onSuccess(){history.goBack();}}),/*#__PURE__*/React.createElement(\"h4\",{className:\"fw-bold text-center togo-border\"},\"Available offers\")),!costDetail.length&&orderStatus==\"WAITING-FOR-BIDS\"&&/*#__PURE__*/React.createElement(\"p\",{className:\"text-center\"},\"No offers\"),!!costDetail.length&&orderStatus==\"AVAILABEL-BIDS\"&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h4\",{className:\"fw-bold text-center togo-border\"},\"Available offers\"),costDetail.map(function(bid){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"align-items-center d-flex justify-content-around mt-3\"},/*#__PURE__*/React.createElement(\"img\",{style:{width:\"100px\",height:\"100px\",objectFit:\"cover\"},src:\"http://46.253.93.4/togo/MobileAPi/\".concat(bid.TransporterPersonalImg)}),/*#__PURE__*/React.createElement(\"div\",null,bid.TransporterName),/*#__PURE__*/React.createElement(\"div\",null,bid.BidCost)),/*#__PURE__*/React.createElement(Button,{className:\"btn-grad rounded-22 mt-3 d-block m-auto\",onClick:function onClick(){AcceptOfferReq(bid.IdTransporterBidRequist,id,bid.BidCost).then(function(resp){if(resp.data.indexOf(\"Success\")!==-1){refreshPage();}});}},\"Accept Offer\"));})),(orderStatus==\"BID-ACCEPTED\"||orderStatus==\"OUT-FOR-DELIVERY\")&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:\"fw-bold text-center togo-border\"},\"Transporter details\"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Label,{val:orderMoreInfo.FullNameCustomer,text:\"Transporter name\"}),/*#__PURE__*/React.createElement(Label,{val:orderMoreInfo.CarNumType,text:\"Vehicle type\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Label,{val:orderMoreInfo.CarLicenceNum,text:\"Vehicle number\"}),/*#__PURE__*/React.createElement(Label,{val:orderMoreInfo.ColorName,text:\"Vehicle color\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Label,{val:orderMoreInfo.TransNumber,text:\"Transporter mobile\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"w-50 text-start d-flex align-items-center shadow-none\"},/*#__PURE__*/React.createElement(\"img\",{src:locationImg,style:{width:\"24px\",height:\"24px\"},className:\"me-1\",alt:\"worldicon\"}),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"97%\"}},\"Track Transporter\")))));}","map":{"version":3,"sources":["/home/system/togo-web-test/src/components/Order/ViewOrder.jsx"],"names":["React","useEffect","useState","useLocation","useParams","useHistory","AcceptOfferReq","GetAllBids","GetClientOrderDetails","locationImg","Order","GetOrderStatus","Button","CancelOrder","refreshPage","Label","val","text","ViewOrder","props","id","location","history","orderInfo","setOrderInfo","orderMoreInfo","setOrderMoreInfo","costDetail","setCostDetails","then","res","data","server_response","OrderDetail","bidsCount","BidCount","CostDetail","orderStatus","IsAcceptDelivery","Orderfinished","pickup_date","length","PickupName","PickupMobile","ReceiverName","ReceiverMobile","goBack","map","bid","width","height","objectFit","TransporterPersonalImg","TransporterName","BidCost","IdTransporterBidRequist","resp","indexOf","FullNameCustomer","CarNumType","CarLicenceNum","ColorName","TransNumber"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useLocation, useParams, useHistory } from \"react-router-dom\";\r\nimport { AcceptOfferReq, GetAllBids, GetClientOrderDetails } from \"../APIs/OrdersAPIs\";\r\nimport locationImg from \"../../assets/locationn.png\";\r\nimport Order, { GetOrderStatus } from \"./Order\";\r\n\r\nimport { Button } from \"react-bootstrap\";\r\nimport { CancelOrder } from \"../OrdersManager/CancelOrder\";\r\nimport { refreshPage } from \"../Functions/CommonFunctions\";\r\n\r\nfunction Label({val, text}){\r\n    return (\r\n        <div className=\"w-50\">\r\n            <div className=\"order-prop-label\">{text}</div>\r\n            <div>{val}</div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default function ViewOrder(props) {\r\n    const {id} = useParams();\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n    const [orderInfo, setOrderInfo] = useState({});\r\n    const [orderMoreInfo, setOrderMoreInfo] = useState({});\r\n    const [costDetail, setCostDetails] = useState([]);\r\n\r\n    useEffect(() => {\r\n        GetClientOrderDetails(id).then((res) => {\r\n            setOrderMoreInfo(res.data.server_response[0]);\r\n        });\r\n\r\n        GetAllBids(id).then((res) => {\r\n            setOrderInfo({...res.data.OrderDetail, bidsCount: res.data.BidCount});\r\n            setCostDetails(res.data.CostDetail);\r\n        });\r\n    }, [id]);\r\n    const orderStatus = GetOrderStatus(orderInfo.IsAcceptDelivery, orderInfo.Orderfinished, orderInfo.pickup_date, costDetail.length);\r\n    return (\r\n        <div>\r\n            <Order order={orderInfo/* location.state.orderObj */} id={id} />\r\n            <div className=\"\">\r\n                \r\n                <div className=\"d-flex\">\r\n                    <Label val={orderInfo.PickupName} text={\"Pickup From\"}/>\r\n                    <Label val={orderInfo.PickupMobile} text={\"Pickup Mobile Number\"}/>\r\n                    \r\n                </div>\r\n\r\n                <div className=\"d-flex\">\r\n                    <Label val={orderInfo.ReceiverName} text={\"Receiver Name\"}/>\r\n                    <Label val={orderInfo.ReceiverMobile} text={\"Receiver Mobile Number\"}/>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            { (orderStatus == \"WAITING-FOR-BIDS\" ||  orderStatus == \"AVAILABEL-BIDS\") && <div>\r\n                <CancelOrder\r\n                    orderId={id} \r\n                    className=\"mt-3 d-flex align-items-center m-auto btn-grad rounded-22\" \r\n                    onSuccess={()=>{\r\n                        history.goBack();\r\n                    }} \r\n                />\r\n                <h4 className=\"fw-bold text-center togo-border\">Available offers</h4>\r\n            </div>\r\n            }\r\n            \r\n            {!costDetail.length && orderStatus == \"WAITING-FOR-BIDS\" && \r\n                <p className=\"text-center\">No offers</p>\r\n            }\r\n            {!!costDetail.length && orderStatus == \"AVAILABEL-BIDS\" && <div>\r\n                <h4 className=\"fw-bold text-center togo-border\">Available offers</h4>\r\n                {costDetail.map((bid) => {\r\n                    return (\r\n                        <div>\r\n                            <div className=\"align-items-center d-flex justify-content-around mt-3\">\r\n                                <img \r\n                                    style={{width: \"100px\", height: \"100px\", objectFit: \"cover\"}} \r\n                                    src={`http://46.253.93.4/togo/MobileAPi/${bid.TransporterPersonalImg}`} \r\n                                />\r\n                                <div>{bid.TransporterName}</div>\r\n                                <div>{bid.BidCost}</div>\r\n                            </div>\r\n                            <Button\r\n                                className=\"btn-grad rounded-22 mt-3 d-block m-auto\" \r\n                                onClick={()=>{\r\n                                    AcceptOfferReq(\r\n                                        bid.IdTransporterBidRequist,\r\n                                        id,\r\n                                        bid.BidCost\r\n                                    ).then((resp)=>{\r\n                                        if(resp.data.indexOf(\"Success\") !== -1){\r\n                                            refreshPage();\r\n                                        }\r\n                                    })\r\n                                }}>\r\n                                    Accept Offer\r\n                                </Button>\r\n                        </div>\r\n                    )\r\n                })}\r\n            </div>}\r\n\r\n            { (orderStatus == \"BID-ACCEPTED\" || orderStatus == \"OUT-FOR-DELIVERY\" ) && \r\n            <div>\r\n                \r\n                <h1 className=\"fw-bold text-center togo-border\">Transporter details</h1>\r\n\r\n                <div className=\"d-flex\">\r\n                    <Label val={orderMoreInfo.FullNameCustomer} text={\"Transporter name\"} />\r\n                    <Label val={orderMoreInfo.CarNumType} text={\"Vehicle type\"} />\r\n                </div>\r\n                <div className=\"d-flex\">\r\n                    <Label val={orderMoreInfo.CarLicenceNum} text={\"Vehicle number\"} />\r\n                    <Label val={orderMoreInfo.ColorName} text={\"Vehicle color\"} />\r\n                </div>\r\n                <div className=\"d-flex\">\r\n                    <Label val={orderMoreInfo.TransNumber} text={\"Transporter mobile\"} />\r\n                    <div className=\"w-50 text-start d-flex align-items-center shadow-none\">\r\n                        <img src={locationImg} style={{width: \"24px\", height: \"24px\"}} className=\"me-1\" alt=\"worldicon\" />\r\n                        <div style={{width: \"97%\"}}>    \r\n                            Track Transporter\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>}\r\n        </div>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}