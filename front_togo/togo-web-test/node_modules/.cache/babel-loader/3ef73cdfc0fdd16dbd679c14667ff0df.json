{"ast":null,"code":"import _slicedToArray from\"/home/system/togo-web-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState}from\"react\";import{useEffect}from\"react\";import{Button,FormControl,Spinner}from\"react-bootstrap\";import{useHistory}from\"react-router-dom\";import{ActivateUser,ResendCode}from\"./APIs/LoginAPIs\";import{setAuth}from\"../Actions/GeneralActions\";import TogoContainer from\"./TogoContainer\";import{useDispatch}from\"react-redux\";import CryptoJS from\"crypto-js\";export default function ActivationCodeForm(){var firstNumRef=useRef();var dispatch=useDispatch();var secNumRef=useRef();var thirdNumRef=useRef();var forthNumRef=useRef();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),disableResend=_useState2[0],setDisableResend=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingSubmit=_useState4[0],setLoadingSubmit=_useState4[1];var history=useHistory();useEffect(function(){var timer;if(disableResend){timer=setTimeout(function(){setDisableResend(false);},60000);}return function(){clearTimeout(timer);};},[disableResend]);return/*#__PURE__*/React.createElement(TogoContainer,null,/*#__PURE__*/React.createElement(\"p\",null,\"Please enter the activation code that was sent to Phone number \",localStorage.getItem(\"PhoneNumber\")),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-evenly my-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"togo-outling\",style:{width:\"44px\"}},/*#__PURE__*/React.createElement(FormControl,{maxLength:1,onInput:function onInput(ev){ev.target.value=ev.target.value.replace(/[^0-9]/gi,\"\");},type:\"text\",className:\"rounded-circle text-center\",ref:firstNumRef})),/*#__PURE__*/React.createElement(\"div\",{className:\"togo-outling\",style:{width:\"44px\"}},/*#__PURE__*/React.createElement(FormControl,{maxLength:1,onInput:function onInput(ev){ev.target.value=ev.target.value.replace(/[^0-9]/gi,\"\");},type:\"text\",className:\"rounded-circle text-center\",ref:secNumRef})),/*#__PURE__*/React.createElement(\"div\",{className:\"togo-outling\",style:{width:\"44px\"}},/*#__PURE__*/React.createElement(FormControl,{maxLength:1,onInput:function onInput(ev){ev.target.value=ev.target.value.replace(/[^0-9]/gi,\"\");},type:\"text\",className:\"rounded-circle text-center\",ref:thirdNumRef})),/*#__PURE__*/React.createElement(\"div\",{className:\"togo-outling\",style:{width:\"44px\"}},/*#__PURE__*/React.createElement(FormControl,{maxLength:1,onInput:function onInput(ev){ev.target.value=ev.target.value.replace(/[^0-9]/gi,\"\");},type:\"text\",className:\"rounded-circle text-center\",ref:forthNumRef}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between\"},/*#__PURE__*/React.createElement(Button,{variant:\"\",disabled:disableResend,onClick:function onClick(){setDisableResend(true);ResendCode().then(function(){});}},\"Resend code\"),/*#__PURE__*/React.createElement(Button,{variant:\"\",onClick:function onClick(){history.push(\"/login\");}},\"Change mobile number\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{variant:\"\",className:\"togo-button w-75 rounded-22\",disabled:loadingSubmit,onClick:function onClick(){setLoadingSubmit(true);var code=\"\".concat(firstNumRef.current.value).concat(secNumRef.current.value).concat(thirdNumRef.current.value).concat(forthNumRef.current.value);var currentTime=+new Date();var hash=CryptoJS.SHA1(currentTime+\"\");var shasum=CryptoJS.enc.Hex.stringify(hash);ActivateUser(localStorage.getItem(\"RegPostCode\")+localStorage.getItem(\"PhoneNumber\"),code,shasum).then(function(res){var _res$data$server_resp;var userInfo=(_res$data$server_resp=res.data.server_response)===null||_res$data$server_resp===void 0?void 0:_res$data$server_resp[0];if(userInfo){localStorage.setItem(\"userId\",userInfo.id);localStorage.setItem(\"TokenDevice\",shasum);localStorage.setItem(\"UserType\",userInfo.IsClient===\"1\"?\"client\":\"transporter\");dispatch(setAuth(true));}if(userInfo.FlagRegistration===\"ClientPersonalInfo\"){//\"ClientRegistration\"\nhistory.push(\"/personal-info\");return;}//TransporterPersonalInfo\n//TrsnsporterCarInfo\n//TransporterWorkCityInfo\n//TransporterWorkTimeInfo\n//TransporterCompletedRegistration\n// localStorage.setItem(\"IsTransporterMaster\", response.data.ResultArray[0].IsTransporterMaster);\n// localStorage.setItem(\"IsTeamMember\", response.data.ResultArray[0].IsTeamMember)\nsetLoadingSubmit(false);history.push(\"/dashboard\");});}},loadingSubmit&&/*#__PURE__*/React.createElement(Spinner,{animation:\"border\",size:\"sm\"}),\"Accept\")));}","map":null,"metadata":{},"sourceType":"module"}